<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">

  
  <title>Bootstrap Colorpicker | ColorHandler.js - Documentation</title>
  

  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-85082661-5"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date()); gtag('config', 'UA-85082661-5');
  </script>

  <link type="image/png" rel="shortcut icon" href="https://farbelous.io/bootstrap-colorpicker/logo.png"/>

  
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css"/>
  

  <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" rel="stylesheet">

  <link href="dist/css/bootstrap-colorpicker.css?v=1532640436843" rel="stylesheet" />

  <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
  <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
  <link type="text/css" rel="stylesheet" href="styles/jsdoc-custom.css">

  <style>
    html {font-size: 14px;}
  </style>

  <!-- This needs to be loaded before the examples scripts: -->
  <script src="//code.jquery.com/jquery-3.3.1.js"></script>

  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.bundle.min.js"></script>

  <script src="dist/js/bootstrap-colorpicker.js?v=1532640436843"></script>
</head>
<body>
<div class="container-fluid">
  <div class="row is-flex">
    <nav class="main-nav col-md-3 col-lg-2">
      <li class="nav-link nav-logo-link"><a class="nav-logo" href="index.html" title="Bootstrap Colorpicker"><img alt="Home" src="logo.png" /></a><span class="nav-logo-title">Bootstrap Colorpicker</span></li><li class="search-box"><input placeholder="Search" class="form-control" type="search" /></li><li class="nav-heading">Examples</li><li class="nav-item nav-item-kind-default"><a href="tutorial-Basics.html">Getting started</a></li><li class="nav-item nav-item-kind-default"><a href="tutorial-p02_Advanced_Examples.html">Advanced examples</a></li><li class="nav-item nav-item-kind-default"><a href="tutorial-p03_Colorpicker_Events.html">Events</a></li><li class="nav-item nav-item-kind-default"><a href="tutorial-p04_Colorpicker_Extensions.html">Extensions</a></li><li class="nav-item nav-item-kind-default"><a href="tutorial-p05_OlderVersions.html">Older versions</a></li><li class="nav-item nav-item-kind-default"><a href="tutorial-p06_SupportUs.html">Support this project</a></li><li class="nav-heading">Classes</li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="ColorItem.html">ColorItem</a></span></li><li class="nav-item nav-item-kind-function"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ColorItem.html#.isHex">isHex</a></span></li><li class="nav-item nav-item-kind-function"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ColorItem.html#.parse">parse</a></span></li><li class="nav-item nav-item-kind-function"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ColorItem.html#.sanitizeFormat">sanitizeFormat</a></span></li><li class="nav-item nav-item-kind-function"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ColorItem.html#.sanitizeString">sanitizeString</a></span></li><li class="nav-item nav-item-kind-function"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ColorItem.html#api">api</a></span></li><li class="nav-item nav-item-kind-function"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ColorItem.html#equals">equals</a></span></li><li class="nav-item nav-item-kind-function"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ColorItem.html#generate">generate</a></span></li><li class="nav-item nav-item-kind-function"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ColorItem.html#getClone">getClone</a></span></li><li class="nav-item nav-item-kind-function"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ColorItem.html#getCloneHueOnly">getCloneHueOnly</a></span></li><li class="nav-item nav-item-kind-function"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ColorItem.html#getCloneOpaque">getCloneOpaque</a></span></li><li class="nav-item nav-item-kind-function"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ColorItem.html#hasAlpha">hasAlpha</a></span></li><li class="nav-item nav-item-kind-function"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ColorItem.html#hasTransparency">hasTransparency</a></span></li><li class="nav-item nav-item-kind-function"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ColorItem.html#isDark">isDark</a></span></li><li class="nav-item nav-item-kind-function"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ColorItem.html#isDesaturated">isDesaturated</a></span></li><li class="nav-item nav-item-kind-function"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ColorItem.html#isLight">isLight</a></span></li><li class="nav-item nav-item-kind-function"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ColorItem.html#isTransparent">isTransparent</a></span></li><li class="nav-item nav-item-kind-function"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ColorItem.html#isValid">isValid</a></span></li><li class="nav-item nav-item-kind-function"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ColorItem.html#replace">replace</a></span></li><li class="nav-item nav-item-kind-function"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ColorItem.html#string">string</a></span></li><li class="nav-item nav-item-kind-function"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ColorItem.html#toHexString">toHexString</a></span></li><li class="nav-item nav-item-kind-function"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ColorItem.html#toHslString">toHslString</a></span></li><li class="nav-item nav-item-kind-function"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ColorItem.html#toHsva">toHsva</a></span></li><li class="nav-item nav-item-kind-function"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ColorItem.html#toObject">toObject</a></span></li><li class="nav-item nav-item-kind-function"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ColorItem.html#toRgbString">toRgbString</a></span></li><li class="nav-item nav-item-kind-function"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="ColorItem.html#toString">toString</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Colorpicker.html">Colorpicker</a></span></li><li class="nav-item nav-item-kind-function"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Colorpicker.html#destroy">destroy</a></span></li><li class="nav-item nav-item-kind-function"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Colorpicker.html#disable">disable</a></span></li><li class="nav-item nav-item-kind-function"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Colorpicker.html#enable">enable</a></span></li><li class="nav-item nav-item-kind-function"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Colorpicker.html#getValue">getValue</a></span></li><li class="nav-item nav-item-kind-function"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Colorpicker.html#hide">hide</a></span></li><li class="nav-item nav-item-kind-function"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Colorpicker.html#isDisabled">isDisabled</a></span></li><li class="nav-item nav-item-kind-function"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Colorpicker.html#registerExtension">registerExtension</a></span></li><li class="nav-item nav-item-kind-function"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Colorpicker.html#setValue">setValue</a></span></li><li class="nav-item nav-item-kind-function"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Colorpicker.html#show">show</a></span></li><li class="nav-item nav-item-kind-function"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Colorpicker.html#toggle">toggle</a></span></li><li class="nav-item nav-item-kind-function"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Colorpicker.html#trigger">trigger</a></span></li><li class="nav-item nav-item-kind-function"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Colorpicker.html#update">update</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Extension.html">Extension</a></span></li><li class="nav-item nav-item-kind-function"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Extension.html#onChange">onChange</a></span></li><li class="nav-item nav-item-kind-function"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Extension.html#onCreate">onCreate</a></span></li><li class="nav-item nav-item-kind-function"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Extension.html#onDestroy">onDestroy</a></span></li><li class="nav-item nav-item-kind-function"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Extension.html#onDisable">onDisable</a></span></li><li class="nav-item nav-item-kind-function"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Extension.html#onEnable">onEnable</a></span></li><li class="nav-item nav-item-kind-function"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Extension.html#onHide">onHide</a></span></li><li class="nav-item nav-item-kind-function"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Extension.html#onInvalid">onInvalid</a></span></li><li class="nav-item nav-item-kind-function"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Extension.html#onShow">onShow</a></span></li><li class="nav-item nav-item-kind-function"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Extension.html#onUpdate">onUpdate</a></span></li><li class="nav-item nav-item-kind-function"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Extension.html#resolveColor">resolveColor</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="HSVAColor.html">HSVAColor</a></span></li><li class="nav-heading">Modules</li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-options.html">options</a></span></li><li class="nav-heading">Events</li><li class="nav-heading"><span class="nav-item-type type-event">E</span><span class="nav-item-name"><a href="Colorpicker.html#event:change">change</a></span></li><li class="nav-heading"><span class="nav-item-type type-event">E</span><span class="nav-item-name"><a href="Colorpicker.html#event:colorpickerChange">colorpickerChange</a></span></li><li class="nav-heading"><span class="nav-item-type type-event">E</span><span class="nav-item-name"><a href="Colorpicker.html#event:colorpickerCreate">colorpickerCreate</a></span></li><li class="nav-heading"><span class="nav-item-type type-event">E</span><span class="nav-item-name"><a href="Colorpicker.html#event:colorpickerDestroy">colorpickerDestroy</a></span></li><li class="nav-heading"><span class="nav-item-type type-event">E</span><span class="nav-item-name"><a href="Colorpicker.html#event:colorpickerDisable">colorpickerDisable</a></span></li><li class="nav-heading"><span class="nav-item-type type-event">E</span><span class="nav-item-name"><a href="Colorpicker.html#event:colorpickerEnable">colorpickerEnable</a></span></li><li class="nav-heading"><span class="nav-item-type type-event">E</span><span class="nav-item-name"><a href="Colorpicker.html#event:colorpickerHide">colorpickerHide</a></span></li><li class="nav-heading"><span class="nav-item-type type-event">E</span><span class="nav-item-name"><a href="Colorpicker.html#event:colorpickerInvalid">colorpickerInvalid</a></span></li><li class="nav-heading"><span class="nav-item-type type-event">E</span><span class="nav-item-name"><a href="Colorpicker.html#event:colorpickerShow">colorpickerShow</a></span></li><li class="nav-heading"><span class="nav-item-type type-event">E</span><span class="nav-item-name"><a href="Colorpicker.html#event:colorpickerUpdate">colorpickerUpdate</a></span></li><li class="nav-heading"><span class="nav-item-type type-event">E</span><span class="nav-item-name"><a href="Colorpicker.html#event:mousemove">mousemove</a></span></li><li class="nav-heading"><span class="nav-item-type type-event">E</span><span class="nav-item-name"><a href="DebuggerExtension.html#event:colorpickerDebug">colorpickerDebug</a></span></li>
    </nav>

    <div class="main-content col-md-9 col-lg-10">
      <div id="main" class="main-content-wrapper">
        
        <h1 class="page-title">ColorHandler.js</h1>
        

        



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>'use strict';

import $ from 'jquery';
import ColorItem from './ColorItem';

/**
 * Handles everything related to the colorpicker color
 * @ignore
 */
class ColorHandler {
  /**
   * @param {Colorpicker} colorpicker
   */
  constructor(colorpicker) {
    /**
     * @type {Colorpicker}
     */
    this.colorpicker = colorpicker;
  }

  /**
   * @returns {*|String|ColorItem}
   */
  get fallback() {
    return this.colorpicker.options.fallbackColor ?
      this.colorpicker.options.fallbackColor : (this.hasColor() ? this.color : null);
  }

  /**
   * @returns {String|null}
   */
  get format() {
    if (this.colorpicker.options.format) {
      return this.colorpicker.options.format;
    }

    if (this.hasColor() &amp;&amp; this.color.hasTransparency() &amp;&amp; this.color.format.match(/^hex/)) {
      return this.isAlphaEnabled() ? 'rgba' : 'hex';
    }

    if (this.hasColor()) {
      return this.color.format;
    }

    return null;
  }

  /**
   * Internal color getter
   *
   * @type {ColorItem|null}
   */
  get color() {
    return this.colorpicker.element.data('color');
  }

  /**
   * Internal color setter
   *
   * @ignore
   * @param {ColorItem|null} value
   */
  set color(value) {
    this.colorpicker.element.data('color', value);

    if ((value instanceof ColorItem) &amp;&amp; (this.colorpicker.options.format === 'auto')) {
      // If format is 'auto', use the first parsed one from now on
      this.colorpicker.options.format = this.color.format;
    }
  }

  bind() {
    // if the color option is set
    if (this.colorpicker.options.color) {
      this.color = this.createColor(this.colorpicker.options.color);
      return;
    }

    // if element[color] is empty and the input has a value
    if (!this.color &amp;&amp; !!this.colorpicker.inputHandler.getValue()) {
      this.color = this.createColor(
        this.colorpicker.inputHandler.getValue(), this.colorpicker.options.autoInputFallback
      );
    }
  }

  unbind() {
    this.colorpicker.element.removeData('color');
  }

  /**
   * Returns the color string from the input value or the 'data-color' attribute of the input or element.
   * If empty, it returns the defaultValue parameter.
   *
   * @returns {String|*}
   */
  getColorString() {
    if (!this.hasColor()) {
      return '';
    }

    return this.color.string(this.format);
  }

  /**
   * Sets the color value
   *
   * @param {String|ColorItem} val
   */
  setColorString(val) {
    let color = val ? this.createColor(val) : null;

    this.color = color ? color : null;
  }

  /**
   * Creates a new color using the widget instance options (fallbackColor, format).
   *
   * @fires Colorpicker#colorpickerInvalid
   * @param {*} val
   * @param {boolean} fallbackOnInvalid
   * @returns {ColorItem}
   */
  createColor(val, fallbackOnInvalid = true) {
    let color = new ColorItem(this.resolveColorDelegate(val), this.format);

    if (!color.isValid()) {
      if (fallbackOnInvalid) {
        color = this.getFallbackColor();
      }

      /**
       * (Colorpicker) Fired when the color is invalid and the fallback color is going to be used.
       *
       * @event Colorpicker#colorpickerInvalid
       */
      this.colorpicker.trigger('colorpickerInvalid', color, val);
    }

    if (!this.isAlphaEnabled()) {
      // Alpha is disabled
      color.alpha = 1;
    }

    return color;
  }

  getFallbackColor() {
    if (this.fallback === this.color) {
      return this.color;
    }

    let fallback = this.resolveColorDelegate(this.fallback);
    let color = new ColorItem(fallback, this.format);

    if (!color.isValid()) {
      throw new Error('The fallback color is invalid.');
    }

    return color;
  }

  /**
   * Delegates the color resolution to the colorpicker extensions.
   *
   * @param {String|*} color
   * @param {boolean} realColor if true, the color should resolve into a real (not named) color code
   * @returns {ColorItem|String|*|null}
   */
  resolveColorDelegate(color, realColor = true) {
    let extResolvedColor = false;

    $.each(this.colorpicker.extensions, function (name, ext) {
      if (extResolvedColor !== false) {
        // skip if resolved
        return;
      }
      extResolvedColor = ext.resolveColor(color, realColor);
    });

    return extResolvedColor ? extResolvedColor : color;
  }

  /**
   * Checks if there is a color object, that it is valid and it is not a fallback
   * @returns {boolean}
   */
  isInvalidColor() {
    return !this.hasColor() || !this.color.isValid();
  }

  /**
   * Returns true if the useAlpha option is exactly true, false otherwise
   * @returns {boolean}
   */
  isAlphaEnabled() {
    return (this.colorpicker.options.useAlpha !== false);
  }

  /**
   * Returns true if the current color object is an instance of Color, false otherwise.
   * @returns {boolean}
   */
  hasColor() {
    return this.color instanceof ColorItem;
  }
}

export default ColorHandler;
</code></pre>
        </article>
    </section>




      </div>
    </div>
  </div>
  <div class="row">
    <footer class="col-md-12 main-footer">
      Generated by <a
      href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a>
      
      on Thu Jul 26 2018 23:27:16 GMT+0200 (CEST) using a custom Minami theme. Search powered by Algolia.
    </footer>
  </div>
</div>

<script src="dist/js/bootstrap-colorpicker.js?v=1532640436843"></script>


<script type="text/javascript" src="//cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
<script type="text/javascript"> docsearch({
  apiKey: '2fbe42dafb0dca80b2422f5b0b2cd82c',
  indexName: 'farbelous_bootstrap_colorpicker',
  inputSelector: '.search-box input',
  algoliaOptions: {
    hitsPerPage: 10
  },
  debug: false // Set debug to true if you want to inspect the dropdown
});
</script>


<script src="scripts/prettify/prettify.js"></script>
<script src="scripts/prettify/lang-css.js"></script>
<script src="scripts/jsdoc.js?v=1532640436843"></script>
</body>
</html>
